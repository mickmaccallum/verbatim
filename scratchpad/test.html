<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test</title>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    
    <h1>Test</h1>

    <script>

    var cars = [];
    var $table = $("<table border = 1></table>");
    var index = 0;
    var highestPrice = 0;
    var carName = "";
    var data;

    $.getJSON('http://127.0.0.1:4000/json/cars.json', function (json) {
    console.log(json)
    for (var key in json) {
        if (json.hasOwnProperty(key)) {
            var item = json[key];
            cars.push({
                make: item.make,
                model: item.model,
                price: item.price,
                year: item.year
            });       
        }
    }

    for (var i = 0; i < json.cars.length; i++) {
        var car = json.cars[i];
        var $line = $("<tr></tr>");
        $line.append($("<td></td>").html(car.make));
        $line.append($("<td></td>").html(car.model));
        $line.append($("<td></td>").html(car.price));
        $line.append($("<td></td>").html(car.year));
        $table.append($line);
        
        if(json.cars[i].price > highestPrice) {
            highestPrice = json.cars[i].price
            carName = json.cars[i].model
            index = i
        }
    }

    console.log("Highest valued car is the " + carName + " at index " + index + " valued at " + highestPrice)
    data = {
        "Model" : carName,
        "Price" : highestPrice
    }
    });

    $table.appendTo(document.body);

    $.post(
        "http://127.0.0.1:4000/john/echo",
        data
    ).done(function(response) {
        console.log(response); // it worked
    }).fail(function(error) {
        console.log(error);
    });

    </script>

</body>
</html>